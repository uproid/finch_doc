{% extends 'template/base.html.twig' %}

{% block content %}
<!-- Main Content Area -->
<main id="main-content" class="flex-1 min-w-0 overflow-x-hidden order-2 xl:order-1 xl:mx-20 lg:mx-16 md:mx-8 sm:mx-4" role="main">
    <div class="flex flex-col xl:flex-row w-full relative">
    
        <!-- Content -->
        <div class="flex-1 w-full py-4 px-4 sm:py-8 sm:px-6 lg:px-8 xl:px-8 max-w-4xl mx-auto">
            {% if $e.isKey('')  %}
                {% include 'template/hero.html.twig' %}
            {% endif %}
            
            <!-- Breadcrumb -->
            <nav class="flex items-center justify-between mb-6 text-sm overflow-x-auto" aria-label="Breadcrumb">
                <ol class="flex items-center space-x-2 flex-nowrap">
                    <li class="whitespace-nowrap"><a href="/" class="text-blue-600 dark:text-secondary-400 hover:underline">{{ $t('Home') }}</a></li>
                    <li class="whitespace-nowrap" aria-hidden="true"><i class="ph-bold {{ language.isRtl ? 'ph-caret-left' : 'ph-caret-right' }} text-base text-gray-400"></i></li>
                    <li class="text-gray-600 dark:text-gray-400 whitespace-nowrap" aria-current="page">{{ title }}</li>
                </ol>
                <div class="flex items-center gap-2 ms-4">
                    <!-- Edit page -->
                    <a href="{{ configs.edit }}/{{ filename }}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 px-3 py-1.5 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap">
                        <i class="ph-bold ph-pencil-simple text-base"></i>
                        <span class="text-xs hidden sm:inline">{{ $t('Edit') }}</span>
                    </a>
                </div>
            </nav>

            <!-- Mobile TOC -->
            <div class="xl:hidden mb-6 p-4 bg-linear-to-br from-gray-50 to-blue-50 dark:from-gray-800 dark:to-gray-700 rounded-lg border border-gray-200 dark:border-gray-700">
                <div class="flex items-center gap-2 mb-3">
                    <i class="ph-bold ph-list-bullets text-blue-600 dark:text-secondary-400"></i>
                    <h3 class="text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wide">{{ $t('On This Page') }}</h3>
                </div>
                <nav>
                    <ul class="flex flex-wrap gap-2">
                        {% for section in index %}
                            <li><a href="#{{ section.id }}" class="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs rounded-lg bg-white dark:bg-gray-700 hover:bg-blue-50 dark:hover:bg-gray-600 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 border border-gray-200 dark:border-gray-600 transition-colors">
                                <i class="ph-bold ph-hash text-xs"></i>
                                {{ section.title | html }}
                            </a></li>
                        {% endfor %}
                    </ul>
                </nav>
            </div>

            <!-- Document Content -->
            <article class="prose prose-sm sm:prose-base lg:prose-lg dark:prose-invert max-w-none overflow-x-auto doc-content">
                {{ content }}
            </article>

            <!-- Navigation Buttons -->
            <div class="flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-4 mt-12 pt-8 border-t-2 border-gray-200 dark:border-gray-700">
                {% if previous is defined %}
                    <a href="/{{ previous.key }}" class="flex-1 group flex items-center gap-3 px-5 py-4 rounded-xl border-2 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600 hover:border-blue-500 dark:hover:border-secondary-400 hover:bg-blue-50 dark:hover:bg-gray-700 transition-all hover:shadow-lg transform hover:-translate-y-0.5">
                        <i class="ph-bold {{ language.isRtl ? 'ph-arrow-right' : 'ph-arrow-left' }} text-2xl text-blue-600 dark:text-secondary-400 group-hover:scale-110 transition-transform"></i>
                        <div class="text-start min-w-0 flex-1">
                            <div class="text-xs text-gray-500 dark:text-gray-400 mb-1">{{ $t('Previous') }}</div>
                            <div class="font-semibold truncate text-gray-900 dark:text-white">{{ previous.title }}</div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">{{  $l.maxLength(previous.description, 50) }}</div>
                        </div>
                    </a>
                {% else %}
                    <div class="flex-1"></div>
                {% endif %}
                {% if next is defined %}
                    <a href="/{{ next.key }}" class="flex-1 group flex items-center gap-3 justify-end px-5 py-4 rounded-xl border-2 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600 hover:border-purple-500 dark:hover:border-purple-400 hover:bg-purple-50 dark:hover:bg-gray-700 transition-all hover:shadow-lg transform hover:-translate-y-0.5">
                        <div class="text-end min-w-0 flex-1">
                            <div class="text-xs text-gray-500 dark:text-gray-400 mb-1">{{ $t('Next') }}</div>
                            <div class="font-semibold truncate text-gray-900 dark:text-white">
                                {{ next.title }}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">{{  $l.maxLength(next.description, 50) }}</div>
                        </div>
                        <i class="ph-bold {{ language.isRtl ? 'ph-arrow-left' : 'ph-arrow-right' }} text-2xl text-purple-600 dark:text-purple-400 group-hover:scale-110 transition-transform"></i>
                    </a>
                {% else %}
                    <div class="flex-1"></div>
                {% endif %}
            </div>

            {% include 'template/footer.html.twig' %}
        </div>
    </div>
</main>
{% endblock %}

{% block rightSide %}
<div class="flex items-center gap-2 mb-4">
    <i class="ph-bold ph-list-dashes text-blue-600 dark:text-secondary-400"></i>
    <h3 class="text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wide">{{ $t('On This Page') }}</h3>
</div>
<nav id="tableOfContents">
    <ul class="space-y-2">
        {% for section in index %}
            <li class="block">
                <a href="#{{ section.id }}" 
                    class="toc-link block px-3 py-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 border-s-2 border-transparent hover:border-blue-600 dark:hover:border-secondary-400 transition-all md-level-{{ section.level }}"
                    data-section="{{ section.id }}">
                    {{ section.title | html }}
                </a>
            </li>
        {% endfor %}
    </ul>
</nav>

<!-- Action Buttons -->
<div class="mt-6 space-y-2 pt-6 border-t border-gray-200 dark:border-gray-700">
    <a href="{{ configs.repository }}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors group">
        <i class="ph-bold ph-github-logo text-lg group-hover:scale-110 transition-transform"></i>
        <span class="text-sm">{{ $t('Star on GitHub') }}</span>
    </a>
    <a href="{{ configs.repository }}/issues/new" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors group">
        <i class="ph-bold ph-warning-circle text-lg group-hover:scale-110 transition-transform"></i>
        <span class="text-sm">{{ $t('Report Issue') }}</span>
    </a>
    <a href="{{ configs.edit }}/{{ filename }}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors group">
        <i class="ph-bold ph-pencil-simple text-lg group-hover:scale-110 transition-transform"></i>
        <span class="text-sm">{{ $t('Edit this page') }}</span>
    </a>
</div>
{% endblock %}