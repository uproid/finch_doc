---
doc_meta:
    group: "æ•°æ®åº“"
    icon: "ph-bold ph-database"
---
# Sqler

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”çµæ´»çš„ Dart SQL æŸ¥è¯¢æ„å»ºå™¨ï¼Œä¸“æ³¨äº MySQL å’Œ SQLite3 æ”¯æŒï¼Œé‡‡ç”¨æµç•…çš„æ¥å£è®¾è®¡ã€‚

[![Pub Version](https://img.shields.io/pub/v/sqler)](https://pub.dev/packages/sqler)
[![Dev](https://img.shields.io/pub/v/sqler.svg?label=dev&include_prereleases)](https://pub.dev/packages/sqler)
[![Donate](https://img.shields.io/badge/Donate-Support.svg)](https://buymeacoffee.com/fardziao)
[![issues-closed](https://img.shields.io/github/issues-closed/uproid/sqler?color=green)](https://github.com/uproid/sqler/issues?q=is%3Aissue+is%3Aclosed) 
[![issues-open](https://img.shields.io/github/issues-raw/uproid/sqler)](https://github.com/uproid/sqler/issues) 
[![Contributions](https://img.shields.io/github/contributors/uproid/sqler)](https://github.com/uproid/sqler/blob/master/CONTRIBUTING.md)



## åŠŸèƒ½ç‰¹æ€§

- **æµç•…æ¥å£**ï¼šä½¿ç”¨æ–¹æ³•é“¾æ„å»º SQL æŸ¥è¯¢ï¼Œæé«˜å¯è¯»æ€§
- **ç±»å‹å®‰å…¨**ï¼šåœ¨ç¼–è¯‘æ—¶å®‰å…¨åœ°æ„é€ æŸ¥è¯¢
- **å…¨é¢æ”¯æŒ**ï¼šSELECTã€INSERTã€UPDATEã€DELETE æ“ä½œ
- **é«˜çº§å­å¥**ï¼šWHEREã€JOINã€GROUP BYã€HAVINGã€ORDER BYã€LIMIT
- **å‚æ•°åŒ–æŸ¥è¯¢**ï¼šæ”¯æŒå‘½åå‚æ•°ä»¥é˜²æ­¢ SQL æ³¨å…¥
- **é€‚å½“è½¬ä¹‰**ï¼šè‡ªåŠ¨å­—æ®µå¼•ç”¨å’Œå€¼è½¬ä¹‰
- **å¤æ‚æ“ä½œ**ï¼šå­æŸ¥è¯¢ã€CASE è¯­å¥ã€èšåˆå‡½æ•°
- **MySQL ä¼˜åŒ–**ï¼šä¸“é—¨é’ˆå¯¹ MySQL è¯­æ³•å’Œç‰¹æ€§è®¾è®¡
- **SQLite ä¼˜åŒ–**ï¼šä¸“é—¨é’ˆå¯¹ SQLite è¯­æ³•å’Œç‰¹æ€§è®¾è®¡

## å®‰è£…

å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°åŒ…çš„ `pubspec.yaml` æ–‡ä»¶ä¸­ï¼š

```yaml
dependencies:
  sqler: 
```
æˆ–

```bash
dart pub add sqler
```

ç„¶åè¿è¡Œï¼š

```bash
dart pub get
```

## å¿«é€Ÿå¼€å§‹

```dart
import 'package:sqler/sqler.dart';

void main() {
  // åˆ›å»ºè¡¨
  var books = MTable(
    name: 'books',
    fields: [
      MFieldInt(name: 'id', isPrimaryKey: true, isAutoIncrement: true),
      MFieldVarchar(name: 'name', length: 255),
      MFieldVarchar(name: 'author', length: 255),
      MFieldInt(name: 'publication_year'),
      MFieldDate(name: 'published_date'),
      MFieldText(name: 'content'),
    ],
  );

  // ç®€å•çš„ SELECT æŸ¥è¯¢
  var query = Sqler()
    .addSelect(QSelect('name'))
    .addSelect(QSelect('published_date'))
    .from(QField('books'))
    .where(WhereOne(QField('publication_year'), QO.EQ, QVar(1980)))
    .orderBy(QOrder('name'))
    .limit(10);

  print(query.toSQL());

  /// æ‰“å° SQLite æ ¼å¼ï¼š
  print(query.toSQL<Sqlite>());
}
```

## SQLite

è¦ä»¥ SQLite æ ¼å¼ç”Ÿæˆ SQL æŸ¥è¯¢ï¼Œè¯·å°† Sqlite ä½œä¸ºç±»å‹å‚æ•°ä¼ é€’ç»™ toSQL å‡½æ•°ï¼š

```dart
query.toSQL<Sqlite>()
```

è¿™ç¡®ä¿ç”Ÿæˆçš„ SQL è¯­æ³•ä¸ SQLite å…¼å®¹ã€‚

## æ ¸å¿ƒç±»

### Sqler
ä¸»æŸ¥è¯¢æ„å»ºå™¨ç±»ï¼Œæä¾›æµç•…çš„æ¥å£æ¥æ„é€  SQL æŸ¥è¯¢ã€‚

### QField
è¡¨ç¤ºæ•°æ®åº“å­—æ®µå¹¶è¿›è¡Œé€‚å½“å¼•ç”¨ï¼š
```dart
QField('users.name')     // users.`name`
QField('table_name')     // `table_name`
```

### QVar
è¡¨ç¤ºå€¼å¹¶è¿›è¡Œé€‚å½“è½¬ä¹‰ï¼š
```dart
QVar('string value')     // 'string value'
QVar(123)               // 123
QVar(true)              // true
QVar(null)              // NULL
```

### QSelect
è¡¨ç¤º SELECT å­—æ®µï¼Œå¯é€‰æ‹©åˆ«åï¼š
```dart
QSelect('name')                    // `name`
QSelect('users.name', 'user_name') // users.`name` AS `user_name`
```

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ SELECT æŸ¥è¯¢

```dart
var query = Sqler()
  .addSelect(QSelect('id'))
  .addSelect(QSelect('name'))
  .addSelect(QSelect('email'))
  .from(QField('users'));

print(query.toSQL());
// SELECT `id`, `name`, `email` FROM `users`
```

### å¸¦ WHERE æ¡ä»¶çš„ SELECT

```dart
var query = Sqler()
  .addSelect(QSelect('*'))
  .from(QField('users'))
  .where(AndWhere([
    WhereOne(QField('active'), QO.EQ, QVar(true)),
    WhereOne(QField('age'), QO.GT, QVar(18))
  ]));

print(query.toSQL());
// SELECT * FROM `users` WHERE ( ( `active` = true ) ) AND ( ( `age` > 18 ) )
```

### å¸¦ JOIN çš„ SELECT

```dart
var query = Sqler()
  .addSelect(QSelect('users.name'))
  .addSelect(QSelect('profiles.bio'))
  .from(QField('users'))
  .join(LeftJoin('profiles', On([
    Condition(QField('users.id'), QO.EQ, QField('profiles.user_id'))
  ])))
  .where(WhereOne(QField('users.active'), QO.EQ, QVar(true)));

print(query.toSQL());
// SELECT `users`.`name`, `profiles`.`bio` FROM `users` 
// LEFT JOIN `profiles` ON ( ( `users`.`id` = `profiles`.`user_id` ) ) 
// WHERE ( `users`.`active` = true )
```

### INSERT æ“ä½œ

```dart
// å•è®°å½•æ’å…¥
var query = Sqler()
  .insert(QField('users'), [
    {
      'name': QVar('John Doe'),
      'email': QVar('john@example.com'),
      'active': QVar(true),
      'age': QVar(30)
    }
  ]);

print(query.toSQL());
// INSERT INTO `users` (`name`, `email`, `active`, `age`) 
// VALUES ('John Doe', 'john@example.com', true, 30)
```

```dart
// å¤šè®°å½•æ’å…¥
var query = Sqler()
  .insert(QField('users'), [
    {
      'name': QVar('John Doe'),
      'email': QVar('john@example.com')
    },
    {
      'name': QVar('Jane Smith'),
      'email': QVar('jane@example.com')
    }
  ]);

print(query.toSQL());
// INSERT INTO `users` (`name`, `email`) 
// VALUES ('John Doe', 'john@example.com'), ('Jane Smith', 'jane@example.com')
```

### UPDATE æ“ä½œ

```dart
var query = Sqler()
  .update(QField('users'), {
    'name': QVar('Updated Name'),
    'email': QVar('updated@example.com')
  })
  .where(WhereOne(QField('id'), QO.EQ, QVar(1)));

print(query.toSQL());
// UPDATE `users` SET `name` = 'Updated Name', `email` = 'updated@example.com' 
// WHERE ( `id` = 1 )
```

### DELETE æ“ä½œ

```dart
var query = Sqler()
  .delete()
  .from(QField('users'))
  .where(WhereOne(QField('active'), QO.EQ, QVar(false)));

print(query.toSQL());
// DELETE FROM `users` WHERE ( `active` = false )
```

### å¸¦ GROUP BY å’Œ HAVING çš„å¤æ‚æŸ¥è¯¢

```dart
var query = Sqler()
  .addSelect(QSelect('department'))
  .addSelect(QSelectFunc('COUNT', [QField('id')], 'employee_count'))
  .from(QField('employees'))
  .where(WhereOne(QField('active'), QO.EQ, QVar(true)))
  .groupBy(QField('department'))
  .having(HavingOne(QSelectFunc('COUNT', [QField('id')]), QO.GT, QVar(5)))
  .orderBy(QOrder('employee_count', OrderDirection.DESC));

print(query.toSQL());
// SELECT `department`, COUNT(`id`) AS `employee_count` FROM `employees` 
// WHERE ( `active` = true ) GROUP BY `department` 
// HAVING ( COUNT(`id`) > 5 ) ORDER BY `employee_count` DESC
```

### å‚æ•°åŒ–æŸ¥è¯¢

```dart
var query = Sqler()
  .addSelect(QSelect('*'))
  .from(QField('users'))
  .where(WhereOne(QField('name'), QO.EQ, QParam('user_name')))
  .param('user_name', QVar('John Doe'));

print(query.toSQL());
// SELECT * FROM `users` WHERE ( `name` = :user_name )

var params = query.getParams();
// {'user_name': QVar('John Doe')}
```

## æ“ä½œç¬¦

`QO` ç±»æä¾›å„ç§æ¯”è¾ƒæ“ä½œç¬¦ï¼š

- `QO.EQ` - ç­‰äº (=)
- `QO.NE` - ä¸ç­‰äº (!=)
- `QO.GT` - å¤§äº (>)
- `QO.GTE` - å¤§äºæˆ–ç­‰äº (>=)
- `QO.LT` - å°äº (<)
- `QO.LTE` - å°äºæˆ–ç­‰äº (<=)
- `QO.LIKE` - LIKE æ¨¡å¼åŒ¹é…
- `QO.NOT_LIKE` - NOT LIKE æ¨¡å¼åŒ¹é…
- `QO.IN` - IN åˆ—è¡¨
- `QO.NOT_IN` - NOT IN åˆ—è¡¨
- `QO.IS_NULL` - IS NULL
- `QO.IS_NOT_NULL` - IS NOT NULL

## WHERE æ¡ä»¶

### åŸºæœ¬æ¡ä»¶
```dart
WhereOne(QField('status'), QO.EQ, QVar('active'))
```

### ç»„åˆæ¡ä»¶
```dart
AndWhere([
  WhereOne(QField('active'), QO.EQ, QVar(true)),
  WhereOne(QField('age'), QO.GTE, QVar(18))
])

OrWhere([
  WhereOne(QField('role'), QO.EQ, QVar('admin')),
  WhereOne(QField('role'), QO.EQ, QVar('moderator'))
])
```

## JOIN ç±»å‹

- `InnerJoin` - INNER JOIN
- `LeftJoin` - LEFT JOIN  
- `RightJoin` - RIGHT JOIN

```dart
.join(InnerJoin('table2', On([
  Condition(QField('table1.id'), QO.EQ, QField('table2.table1_id'))
])))
```

## ğŸš€ Beta ç‰ˆæœ¬ - æ‚¨çš„è´¡çŒ®å¾ˆé‡è¦ï¼

**Sqler ç›®å‰å¤„äº beta ç‰ˆæœ¬ï¼** æˆ‘ä»¬å¾ˆé«˜å…´ä¸ Dart ç¤¾åŒºåˆ†äº«è¿™ä¸ªå¼ºå¤§çš„ SQL æŸ¥è¯¢æ„å»ºå™¨ï¼Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°æ‚¨çš„å¸®åŠ©ä½¿å…¶å˜å¾—æ›´å¥½ã€‚

### æ‚¨å¯ä»¥å¦‚ä½•å¸®åŠ©

è¿™ä¸ª beta ç‰ˆæœ¬æ„å‘³ç€æˆ‘ä»¬æ­£åœ¨ç§¯æå¯»æ±‚åƒæ‚¨è¿™æ ·çš„å¼€å‘è€…çš„åé¦ˆå’Œè´¡çŒ®ï¼ä»¥ä¸‹æ˜¯ä¸€äº›å‚ä¸æ–¹å¼ï¼š

- ğŸ› **é”™è¯¯æŠ¥å‘Š**ï¼šå‘ç°äº†ä¸ç¬¦åˆé¢„æœŸçš„é—®é¢˜ï¼Ÿè¯·æäº¤ issueï¼
- ğŸ“ **æ–‡æ¡£**ï¼šå¸®åŠ©æˆ‘ä»¬æ”¹è¿›æ–‡æ¡£ã€ç¤ºä¾‹å’ŒæŒ‡å—
- ğŸ’¡ **åŠŸèƒ½è¯·æ±‚**ï¼šæœ‰æ–°åŠŸèƒ½çš„æƒ³æ³•ï¼Ÿæˆ‘ä»¬å¾ˆä¹æ„å¬å–ï¼
- ğŸ”§ **ä»£ç è´¡çŒ®**ï¼šæäº¤ Pull Request å¸®åŠ©æ”¹è¿›ä»£ç åº“
- ğŸ§ª **æµ‹è¯•**ï¼šåœ¨æ‚¨çš„é¡¹ç›®ä¸­ä½¿ç”¨ Sqler å¹¶åˆ†äº«æ‚¨çš„ä½“éªŒ

### è¡¨è¾¾æ‚¨çš„æ”¯æŒ

ç”±äºæˆ‘ä»¬ä½¿ç”¨ **æ˜Ÿæ ‡å’Œè¯„åˆ†ä½œä¸ºä¸»è¦æŒ‡æ ‡** æ¥è¡¡é‡ç¤¾åŒºå…´è¶£å¹¶æŒ‡å¯¼æˆ‘ä»¬çš„å¼€å‘ä¼˜å…ˆçº§ï¼Œå¦‚æœæ‚¨èƒ½ï¼š

- â­ **åœ¨ GitHub ä¸Šç»™æˆ‘ä»¬åŠ æ˜Ÿ**ï¼šå¸®åŠ©å…¶ä»–äººå‘ç° Sqlerï¼
- ğŸ‘ **å–œæ¬¢è¿™ä¸ªåŒ…**ï¼šæ‚¨çš„æ”¯æŒæ¿€åŠ±æˆ‘ä»¬ä¸æ–­æ”¹è¿›
- ğŸ“¢ **ä¸ä»–äººåˆ†äº«**ï¼šå‘Šè¯‰å…¶ä»–å¼€å‘è€…å…³äº Sqler

æ‚¨çš„åé¦ˆå’Œè´¡çŒ®å¯¹äºå¸®åŠ©æˆ‘ä»¬æ„å»ºæœ€å¥½çš„ Dart SQL æŸ¥è¯¢æ„å»ºå™¨éå¸¸å®è´µã€‚æ„Ÿè°¢æ‚¨æˆä¸ºæˆ‘ä»¬æ—…ç¨‹çš„ä¸€éƒ¨åˆ†ï¼ğŸ™

## è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤ Pull Requestã€‚å¯¹äºé‡å¤§æ›´æ”¹ï¼Œè¯·å…ˆå¼€å¯ä¸€ä¸ª issue è®¨è®ºæ‚¨æƒ³è¦æ›´æ”¹çš„å†…å®¹ã€‚

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ä»£ç ä»“åº“

[https://github.com/uproid/sqler](https://github.com/uproid/sqler)
